<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Điểm danh - BetterHeal</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/navigation.css">
    <link rel="stylesheet" href="css/attendance.css">
    <link rel="stylesheet" href="css/fixed-attendance.css">
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="apple-touch-icon" href="favicon.png">
    <meta name="theme-color" content="#5b8a72">
    <style>
        @keyframes pulse {
            0% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(220, 53, 69, 0.7);
            }
            70% {
                transform: scale(1.1);
                box-shadow: 0 0 0 5px rgba(220, 53, 69, 0);
            }
            100% {
                transform: scale(1);
            }
        }
    </style>
</head>
<body>
    <header class="premium-header">
        <nav class="navbar-container">
            <button class="mobile-toggle" aria-label="Toggle Menu">
                <i class="fas fa-bars"></i>
            </button>
            <a href="dashboard.html" class="logo-brand">
                <i class="fas fa-heart"></i> BetterHeal
            </a>
            <ul class="nav-menu">
                <li class="nav-item"><a href="dashboard.html" class="nav-link-custom"><i class="fas fa-home"></i> <span>Trang chủ</span></a></li>
                <li class="nav-item"><a href="feelings.html" class="nav-link-custom"><i class="fas fa-heart-pulse"></i> <span>Nỗi lòng</span></a></li>
                <li class="nav-item"><a href="journal.html" class="nav-link-custom"><i class="fas fa-book-open"></i> <span>Nhật ký</span></a></li>
                <li class="nav-item"><a href="foryou.html" class="nav-link-custom"><i class="fas fa-hand-holding-heart"></i> <span>For You</span></a></li>
                <li class="nav-item"><a href="community.html" class="nav-link-custom"><i class="fas fa-comments"></i> <span>Tâm sự</span></a></li>
            </ul>
            <div class="nav-actions">
                <div id="authButtons" class="auth-container" style="display: none;">
                    <a href="login.html" class="btn">Đăng nhập</a>
                    <a href="register.html" class="btn btn-secondary">Đăng ký</a>
                    <a href="login.html" class="auth-pill" title="Đăng nhập" style="display: none;">
                        <i class="fas fa-sign-in-alt"></i>
                    </a>
                </div>
                <div id="userInfo" class="user-profile" style="display: none;">
                    <div class="user-avatar" id="userAvatar">U</div>
                    <span class="user-name" id="userName">User</span>
                    <a href="menu-password-manager.html" id="menuPasswordLink" class="admin-pill" style="display: none;">
                        <i class="fas fa-shield-halved"></i> <span>Quản lý</span>
                    </a>
                    <button id="logoutBtn" class="logout-pill" title="Đăng xuất">
                        <i class="fas fa-arrow-right-from-bracket"></i>
                    </button>
                </div>
            </div>
        </nav>
    </header>

    <main>
        <section class="attendance-header">
            <h1>Điểm danh hàng ngày</h1>
            <p>Điểm danh mỗi ngày để nhận phần thưởng và theo dõi quá trình chữa lành của bạn</p>
        </section>

        <section class="attendance-container">
            <div class="calendar-controls">
                <button id="prevMonth" class="month-nav-btn"><i class="fas fa-chevron-left"></i></button>
                <h2 id="currentMonthYear">Tháng 5, 2023</h2>
                <button id="nextMonth" class="month-nav-btn"><i class="fas fa-chevron-right"></i></button>
            </div>

            <div class="calendar-container">
                <div class="weekdays">
                    <div>CN</div>
                    <div>T2</div>
                    <div>T3</div>
                    <div>T4</div>
                    <div>T5</div>
                    <div>T6</div>
                    <div>T7</div>
                </div>
                <div class="calendar" id="calendarDays">
                    <!-- Calendar days will be generated by JavaScript -->
                </div>
            </div>

            <div class="attendance-stats">
                <div class="stat-card">
                    <i class="fas fa-calendar-day"></i>
                    <div class="stat-info">
                        <h3>Hôm nay</h3>
                        <p id="todayStatus">Chưa điểm danh</p>
                    </div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-fire"></i>
                    <div class="stat-info">
                        <h3>Chuỗi ngày</h3>
                        <p id="streakCount">0 ngày</p>
                    </div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-calendar-check"></i>
                    <div class="stat-info">
                        <h3>Tổng điểm danh</h3>
                        <p id="totalAttendance">0 ngày</p>
                    </div>
                </div>
            </div>

            <div class="attendance-action">
                <button id="checkInBtn" class="check-in-btn">
                    <i class="fas fa-check-circle"></i> Điểm danh ngay
                </button>
                <button id="reloadDataBtn" class="reload-btn">
                    <i class="fas fa-sync-alt"></i> Tải lại dữ liệu
                </button>
            </div>
        </section>

        <section class="rewards-section">
            <h2>Phần thưởng</h2>
            <div class="rewards-container">
                <div class="reward-card">
                    <div class="reward-icon">
                        <i class="fas fa-star"></i>
                    </div>
                    <div class="reward-info">
                        <h3>3 ngày liên tiếp</h3>
                        <p>Huy hiệu "Khởi đầu tốt"</p>
                    </div>
                    <div class="reward-status" id="reward1">
                        <i class="fas fa-lock"></i>
                    </div>
                </div>
                <div class="reward-card">
                    <div class="reward-icon">
                        <i class="fas fa-medal"></i>
                    </div>
                    <div class="reward-info">
                        <h3>7 ngày liên tiếp</h3>
                        <p>Huy hiệu "Kiên trì"</p>
                    </div>
                    <div class="reward-status" id="reward2">
                        <i class="fas fa-lock"></i>
                    </div>
                </div>
                <div class="reward-card">
                    <div class="reward-icon">
                        <i class="fas fa-trophy"></i>
                    </div>
                    <div class="reward-info">
                        <h3>30 ngày liên tiếp</h3>
                        <p>Huy hiệu "Chuyên gia chữa lành"</p>
                    </div>
                    <div class="reward-status" id="reward3">
                        <i class="fas fa-lock"></i>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <p>&copy; 2023 BetterHeal. Tất cả quyền được bảo lưu.</p>
    </footer>

    <div id="attendanceModal" class="modal">
        <div class="modal-content">
            <div class="success-animation">
                <i class="fas fa-calendar-check"></i>
            </div>
            <h2>Điểm danh thành công!</h2>
            <p>Bạn đã điểm danh ngày hôm nay. Hãy quay lại vào ngày mai để tiếp tục chuỗi ngày của bạn.</p>
            <button id="closeModal" class="close-btn">Đóng</button>
        </div>
    </div>

    <div id="milestoneModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" id="closeMilestoneModal">&times;</span>
            <h2 class="modal-title">Đánh dấu cột mốc quan trọng</h2>
            <p id="selectedDateDisplay">Ngày: </p>
            <div class="form-group">
                <label for="milestoneTitle">Chủ đề cột mốc:</label>
                <input type="text" id="milestoneTitle" class="form-control" placeholder="Nhập chủ đề cột mốc quan trọng">
            </div>
            <div class="form-group">
                <label for="milestoneDescription">Mô tả (tùy chọn):</label>
                <textarea id="milestoneDescription" class="form-control" placeholder="Mô tả chi tiết về cột mốc này"></textarea>
            </div>
            <div class="milestone-actions">
                <button id="saveMilestoneBtn" class="btn btn-primary">
                    <i class="fas fa-save"></i> Lưu cột mốc
                </button>
                <button id="removeMilestoneBtn" class="btn btn-danger" style="display: none;">
                    <i class="fas fa-trash-alt"></i> Xóa cột mốc
                </button>
            </div>
        </div>
    </div>

    <!-- Thông báo tùy chỉnh -->
    <div id="customToast" class="custom-toast">
        <div class="toast-content">
            <div class="toast-icon">
                <i class="fas fa-check-circle"></i>
            </div>
            <div class="toast-message">Thông báo</div>
        </div>
        <div class="toast-progress"></div>
    </div>

    <!-- Modal xác nhận xóa -->
    <div id="confirmModal" class="modal">
        <div class="modal-content confirm-modal">
            <h2 class="modal-title">Xác nhận</h2>
            <p id="confirmMessage">Bạn có chắc chắn muốn xóa cột mốc này?</p>
            <div class="confirm-actions">
                <button id="confirmYesBtn" class="btn btn-danger">
                    <i class="fas fa-trash-alt"></i> Xóa
                </button>
                <button id="confirmNoBtn" class="btn btn-secondary">
                    <i class="fas fa-times"></i> Hủy
                </button>
            </div>
        </div>
    </div>

    <script type="module" src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database.js"></script>
    <script type="module" src="js/menu-password-check.js"></script>
    <script src="js/navigation.js"></script>
    <script type="module" src="js/attendance.js"></script>
</body>
</html>
